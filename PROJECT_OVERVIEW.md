# Gemini Content Generator - Project Documentation

## 1. Project Overview
This project is an AI-powered PowerPoint generator. It uses **Google Gemini** (via LangChain/LangGraph) to research and write content, and **python-pptx** to generate professional `.pptx` files.

## 2. Architecture & Flow

The application moves away from a simple linear script to a **Stateful Agentic Workflow** using **LangGraph**.

### High-Level Data Flow:
1.  **User Input** (Topic, Image Preferences) received via Web UI.
2.  **Flask Backend** (`app.py`) receives the request.
3.  **LangGraph Workflow** (`agent_graph.py`) is invoked:
    *   **Step 1: Planner**: Generates a slide outline.
    *   **Step 2: Writer**: Generates detailed content for each slide.
    *   **Step 3: Aggregator**: Formats data for the PPT generator.
4.  **PPT Generation** (`ppt_utils.py`) creates the actual file.
5.  **Download**: User downloads the generated presentation.

---

## 3. Key Components & Functions

### A. Backend - `app.py`
The Flask application that serves the frontend and handles API requests.
*   `GET /`: Serves the `index.html` page.
*   `POST /generate_ppt`:
    *   Extracts `topic`, `include_images`, `image_mode` from the request.
    *   Initializes the `AgentState`.
    *   Calls `graph.invoke(initial_state)` to run the AI agents.
    *   Passes the result to `ppt_utils.create_ppt`.
    *   Returns a download URL.

### B. AI Workflow - `agent_graph.py`
Defines the brain of the application using LangGraph.

**State (`AgentState`)**:
Shared memory passed between nodes. Contains `topic`, `outline`, `slides`, etc.

**Nodes (Agents):**
1.  **`planner_node(state)`**:
    *   **Role**: Architect.
    *   **Input**: User Topic.
    *   **Action**: Prompts Gemini to create a 5-slide structure (Titles only).
    *   **Output**: Updates `state['outline']`.
2.  **`content_node(state)`**:
    *   **Role**: Writer.
    *   **Input**: `outline` from the planner.
    *   **Action**: Prompts Gemini to write concise bullet points (max 5 lines) for each slide header using the *gemini-2.5-flash* model. It creates a hierarchical structure (Main Points vs Sub-points).
    *   **Output**: Updates `state['slides']`.
3.  **`aggregator_node(state)`**:
    *   **Role**: Formatter.
    *   **Action**: Wraps the slides into the final JSON structure expected by the PPT utility.

### C. Presentation Logic - `ppt_utils.py`
Handles the physical creation of the PowerPoint file.

**`create_ppt(data, filename, image_mode)`**:
*   **Layouts**:
    *   Uses **Layout 1 (Title & Content)** for text-only slides.
    *   Uses **Layout 3 (Two Content)** for slides with images.
*   **Typography**:
    *   Iterates through content levels.
    *   **Level 0 (Main Points)**: Sets font to **22pt**.
    *   **Level 1 (Sub-points)**: Sets font to **18pt**.
*   **Image Generation**:
    *   If `image_mode='auto'`, it fetches a dynamic placeholder image from `placehold.co` using the `image_search_query` generated by the AI.
    *   Inserts the image into the right-hand column.

### D. Frontend - `templates/index.html`
A clean, responsive UI.
*   **Inputs**: Topic text input, "Include Images" checkbox, Mode selection (Manual/Auto).
*   **JavaScript**: Handles form submission and displays the "Download" button asynchronously.
